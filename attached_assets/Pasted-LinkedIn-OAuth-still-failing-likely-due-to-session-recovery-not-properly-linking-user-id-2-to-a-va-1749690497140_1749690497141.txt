LinkedIn OAuth still failing, likely due to session recovery not properly linking user_id: 2 to a valid LinkedIn platform_connections entry. Logs show session established, but /auth/linkedin request persists, indicating callback or token issue.

Fix: Update server/routes.ts to ensure LinkedIn OAuth callback properly updates platform_connections with live credentials for user_id: 2. Verify token flow.

ðŸ”§ Replit Prompt â€” Fix LinkedIn OAuth Callback

Task: Resolve LinkedIn OAuth issue in server/routes.ts for user_id: 2 by ensuring the /auth/linkedin/callback properly updates platform_connections with live credentials. Preserve quota enforcement (12/27/52), 30-day reset, and all features (Brand Purpose, Google Analytics).

Requirements:

OAuth Callback Fix:
Update server/routes.ts for /auth/linkedin/callback:
Exchange LinkedIn code for access_token and refresh_token using live client ID/secret.
Update platform_connections for user_id: 2:
platform: 'linkedin'
access_token, refresh_token, expires_at (set to now + token duration)
is_active: true
Link to session user_id: 2 from establish-session.
Redirect to app dashboard on success.
Validation:
Before /auth/linkedin, ensure session user_id: 2 is active.
If platform_connections lacks valid LinkedIn entry, prompt connection via modal: "Connect your LinkedIn account."
Preserve Existing Logic:
Maintain quota (12/27/52) and 30-day reset in post_ledger.
Keep post_schedule and post-publisher.ts unchanged.
Ensure Google Analytics triggers on successful posts.
API Behavior:

GET /auth/linkedin:
Redirect to LinkedIn OAuth with scope (e.g., r_liteprofile r_emailaddress).
GET /auth/linkedin/callback:
Process code, update platform_connections, redirect to /dashboard.
POST /approve-post:
Validate LinkedIn connection for user_id: 2.
Safeguards:

Use live credentials only.
Log callback errors.
Preserve all app functionality.
Commit Message:

text

Collapse

Wrap

Copy
fix: ensure LinkedIn OAuth callback updates platform_connections for user_id: 2 with live credentials
Show in sidebar






1.7s