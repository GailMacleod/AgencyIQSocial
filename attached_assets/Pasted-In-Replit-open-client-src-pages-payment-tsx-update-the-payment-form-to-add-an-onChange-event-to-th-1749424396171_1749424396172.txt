In Replit, open client/src/pages/payment.tsx, update the payment form to add an onChange event to the card number input that checks if the logged-in user’s email is 'testuser@agencyiq.com' and the card number is '4242424242424242'. If true, prevent the real Stripe submission by setting a flag 'isTestPayment' to true, log 'Mock payment initiated for testuser@agencyiq.com with 4242424242424242 using password TestPass123!"', and update only this user’s state to include subscriptions { starter: true, growth: true, professional: true } with a 45-post limit via a mock API call to PUT /api/user/subscription with the user’s ID. On form submission, if 'isTestPayment' is true, return early with a success log 'Mock payment successful for testuser@agencyiq.com', otherwise proceed with normal Stripe submission and log 'Live payment attempted with password TestPass123!"'. Ensure the mock overrides Stripe.js validation completely. Commit with message 'fix-mock-payment-early-intercept' without deploying. Ensure no unauthorized changes beyond this update."
Instructions:
Open client/src/pages/payment.tsx in Replit (ensure it exists).
Apply the prompt as written.
Add the onChange and onSubmit logic as described.
Save the file.
Go to the Git tab, commit with "fix-mock-payment-early-intercept" (do not deploy).
Visit https://agency-iq-social-GailMac.replit.app/payment, log in as Username: testuser@agencyiq.com and Password: TestPass123!", enter 4242424242424242 with any future date and CVC (e.g., 12/30, 123), submit, check console for the mock logs and verify 45-post access at 09:14 AM AEST.
Report the outcome (e.g., mock logs present, no decline error, subscriptions active) and any issues.
Validation:
If the decline error persists, ensure the onChange sets isTestPayment and the onSubmit return is in the correct event handler (e.g., adjust if Stripe.js wraps it differently).
If subscriptions don’t update, confirm the PUT call uses the correct user ID and endpoint.
If live users are affected, verify the email check is strict.
Confirm, report Replit overreach.