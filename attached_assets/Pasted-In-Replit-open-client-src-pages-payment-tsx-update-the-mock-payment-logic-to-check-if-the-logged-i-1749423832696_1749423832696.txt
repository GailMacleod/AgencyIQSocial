In Replit, open client/src/pages/payment.tsx, update the mock payment logic to check if the logged-in user’s email is 'testuser@agencyiq.com' and the card number is '4242424242424242'. If true, prevent the real Stripe submission, log 'Mock payment successful for testuser@agencyiq.com with 4242424242424242 using password TestPass123!"', update only this user’s state to include subscriptions { starter: true, growth: true, professional: true } with a 45-post limit, and set a flag 'isTestMode' to true. If false, proceed with normal Stripe submission and log 'Live payment attempted with password [current password]'. Ensure the mock fully bypasses Stripe’s live API for this user. Commit with message 'fix-mock-payment-test-card-password' without deploying. Ensure no unauthorized changes beyond this update."
Instructions:
Open client/src/pages/payment.tsx in Replit (ensure it exists from the prior implementation).
Apply the updated prompt as written.
Modify the existing mock logic to check if (currentUser.email === 'testuser@agencyiq.com' && cardNumber === '4242424242424242'), where currentUser.email is from your app’s auth state (e.g., Redux, Context), and update the log to include the password TestPass123!".
If true, log console.log('Mock payment successful for testuser@agencyiq.com with 4242424242424242 using password TestPass123!"');, set isTestMode: true, and update subscriptions: { starter: true, growth: true, professional: true } with a 45-post limit (e.g., via state or a mock API call to PUT /api/user/subscription for this user only).
If false, log console.log('Live payment attempted with password [current password]'); (replace [current password] with the actual password from currentUser if accessible) and proceed with Stripe.
Ensure the mock prevents any Stripe API call (e.g., return early or use a mock payment handler).
Save the file.
Go to the Git tab, commit with "fix-mock-payment-test-card-password" (do not deploy).
Visit https://agency-iq-social-GailMac.replit.app/payment (or navigate via the app), log in as Username: testuser@agencyiq.com and Password: TestPass123!", enter 4242424242424242 with any future date and CVC (e.g., 12/30, 123), submit, check console for the mock log and verify 45-post access at 09:05 AM AEST.
Report the outcome (e.g., mock log present, subscriptions active) and any issues.
Validation:
If the error “card declined” persists, ensure the mock logic fully intercepts the Stripe call (e.g., remove the Stripe submit if isTestMode is true).
If subscriptions don’t update, verify the state update targets testuser@agencyiq.com (e.g., via user ID or session) and the password matches.
If live users are affected, tighten the email check logic.
Confirm, report Replit overreach.